var N=Object.defineProperty,q=Object.defineProperties;var S=Object.getOwnPropertyDescriptors;var x=Object.getOwnPropertySymbols;var z=Object.prototype.hasOwnProperty,G=Object.prototype.propertyIsEnumerable;var K=(e,a,n)=>a in e?N(e,a,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[a]=n,T=(e,a)=>{for(var n in a||(a={}))z.call(a,n)&&K(e,n,a[n]);if(x)for(var n of x(a))G.call(a,n)&&K(e,n,a[n]);return e},j=(e,a)=>q(e,S(a));import{_ as H,a as J}from"./ModalDialog.40f4384e.js";import{_ as V,a as P}from"./TableBody.e62a7b46.js";import{b as c,m as F,d as Y,as as Q,e as W,o as p,q as E,a as s,w as r,F as L,I as y,H as X,t as h,c as C,a2 as Z,ai as ee,M as oe,P as ae,aY as ne,by as ue,bH as te,d$ as le,s as se,aq as re,bG as ie,bC as de}from"./vendor.a65504f1.js";/* empty css               *//* empty css               *//* empty css               *//* empty css              *//* empty css               *//* empty css                */import{_ as ce,p as O,h as pe,i as me}from"./index.7e6e9f17.js";import{u as _e,a as fe,c as ve}from"./table.82e568f5.js";const U="ROLE_",D=[{label:"\u89D2\u8272\u540D\u79F0",type:"input",key:"name",value:c(""),required:!0,placeholder:"\u8BF7\u8F93\u5165\u89D2\u8272\u540D\u79F0",validator:function(){return this.value.value?!0:(F.error(this.placeholder),!1)}},{label:"\u89D2\u8272\u7F16\u53F7",key:"roleCode",value:c(""),type:"input",required:!0,placeholder:"\u8BF7\u8F93\u5165\u89D2\u8272\u7F16\u53F7",validator:function(){return this.value.value?!0:(F.error(this.placeholder),!1)}},{label:"\u89D2\u8272\u63CF\u8FF0",key:"description",value:c(""),type:"textarea",placeholder:"\u8BF7\u8F93\u5165\u89D2\u8272\u63CF\u8FF0"}];function $(e,a,n){const _=[];return e.forEach(i=>{const l={};l.key=i.menuUrl,l.title=i.menuName,a.push(l.key),i.children&&(n.push(l.key),l.children=$(i.children,a,n)),_.push(l)}),_}const Fe=Y({name:"Role",setup(){const e=c(null),a=c(null),n=_e(),_=ve("id"),i=c("\u6DFB\u52A0\u89D2\u8272"),l=Q([]),k=fe([n.indexColumn,{title:"\u89D2\u8272\u540D\u79F0",key:"name",dataIndex:"name"},{title:"\u89D2\u8272\u7F16\u53F7",key:"roleCode",dataIndex:"roleCode"},{title:"\u89D2\u8272\u63CF\u8FF0",key:"description",dataIndex:"description"},{title:"\u521B\u5EFA\u65F6\u95F4",key:"createTime",dataIndex:"createTime"},{title:"\u89D2\u8272\u7F16\u53F7",key:"roleCode",dataIndex:"roleCode"},{title:"\u64CD\u4F5C",key:"actions"}],{align:"center"}),f=c([]),m=c([]);function g(){O({url:pe,data:{}}).then(n.handleSuccess).catch(console.log)}function b(){var u;i.value="\u6DFB\u52A0\u89D2\u8272",(u=e.value)==null||u.toggle()}function A(u){var t;i.value="\u7F16\u8F91\u89D2\u8272",(t=e.value)==null||t.toggle(),ee(()=>{D.forEach(o=>{const d=o.key,v=u[d];v&&(o.key==="roleCode"?o.value.value=v.replace(U,""):o.value.value=v)})})}function I(u){oe.confirm({title:"\u63D0\u793A",content:"\u662F\u5426\u8981\u5220\u9664\u6B64\u89D2\u8272\uFF1F",cancelText:"\u53D6\u6D88",okText:"\u5220\u9664",onOk:()=>{F.success("\u6A21\u62DF\u89D2\u8272\u5220\u9664\u6210\u529F\uFF0C\u53C2\u6570\u4E3A"+JSON.stringify(u))}})}function B(){var u;D.every(t=>t.validator?t.validator():!0)&&((u=e.value)==null||u.toggle(),F.success("\u6A21\u62DF\u83DC\u5355\u6DFB\u52A0\u6210\u529F\uFF0C\u53C2\u6570\u4E3A\uFF1A"+JSON.stringify(D.reduce((t,o)=>(t[o.key]=o.value.value,t),{}))))}function M(u){O({url:me,data:{roleId:u.id}}).then(t=>{var o;l.length=0,l.push(...$(t.data,f.value,m.value)),(o=a.value)==null||o.toggle()}).catch(console.log)}function R(){var u;(u=a.value)==null||u.close(),F.success("\u63D0\u4EA4\u6210\u529F: "+JSON.stringify(f.value))}return W(g),j(T({ROLE_CODE_FLAG:U,modalDialogRef:e,menuModalDialogRef:a,rowKey:_,menuData:l,tableColumns:k,formItems:D,actionTitle:i,defaultCheckedKeys:f,defaultExpandedKeys:m},n),{onAddItem:b,onDataFormConfirm:B,onShowMenu:M,onDeleteItem:I,onUpdateItem:A,onMenuConfirm:R})}}),ye={class:"main-container"},he=y("\u7F16\u8F91"),Ce=y("\u5220\u9664"),De=y(" \u83DC\u5355\u6743\u9650 ");function ke(e,a,n,_,i,l){const k=H,f=V,m=ae,g=ne,b=ue,A=P,I=re,B=ie,M=de,R=te,u=J,t=le;return p(),E("div",ye,[s(f,{"show-filter":!1},{"top-right":r(()=>[s(k,{onAdd:e.onAddItem},null,8,["onAdd"])]),_:1}),s(A,null,{default:r(()=>[s(b,{loading:e.tableLoading,"data-source":e.dataList,columns:e.tableColumns,pagination:!1,"row-key":e.rowKey},{bodyCell:r(({column:o,record:d,index:v})=>[o.key==="index"?(p(),E(L,{key:0},[y(X(v+1),1)],2112)):h("v-if",!0),o.key==="actions"?(p(),C(g,{key:1},{default:r(()=>[s(m,{ghost:"",type:"primary",onClick:w=>e.onUpdateItem(d),size:"small"},{default:r(()=>[he]),_:2},1032,["onClick"]),s(m,{danger:"",size:"small",onClick:w=>e.onDeleteItem(d)},{default:r(()=>[Ce]),_:2},1032,["onClick"]),s(m,{ghost:"",type:"primary",size:"small",onClick:w=>e.onShowMenu(d)},{default:r(()=>[De]),_:2},1032,["onClick"])]),_:2},1024)):h("v-if",!0)]),_:1},8,["loading","data-source","columns","row-key"])]),_:1}),s(u,{ref:"modalDialogRef",title:e.actionTitle,onConfirm:e.onDataFormConfirm},{content:r(()=>[s(R,null,{default:r(()=>[(p(!0),E(L,null,Z(e.formItems,o=>(p(),C(M,{class:se([o.required?"form-item__require":"form-item__no_require"]),label:o.label,key:o.key},{default:r(()=>[o.type==="input"?(p(),C(I,{key:0,"addon-before":o.key==="roleCode"?e.ROLE_CODE_FLAG:"",placeholder:o.placeholder,value:o.value.value,"onUpdate:value":d=>o.value.value=d},null,8,["addon-before","placeholder","value","onUpdate:value"])):h("v-if",!0),o.type==="textarea"?(p(),C(B,{key:1,value:o.value.value,"onUpdate:value":d=>o.value.value=d,placeholder:o.placeholder,"auto-size":{minRows:3,maxRows:5}},null,8,["value","onUpdate:value","placeholder"])):h("v-if",!0)]),_:2},1032,["class","label"]))),128))]),_:1})]),_:1},8,["title","onConfirm"]),s(u,{ref:"menuModalDialogRef",title:"\u7F16\u8F91\u83DC\u5355\u6743\u9650",onConfirm:e.onMenuConfirm},{content:r(()=>[s(t,{"tree-data":e.menuData,checkable:"",expandedKeys:e.defaultExpandedKeys,"onUpdate:expandedKeys":a[0]||(a[0]=o=>e.defaultExpandedKeys=o),checkedKeys:e.defaultCheckedKeys,"onUpdate:checkedKeys":a[1]||(a[1]=o=>e.defaultCheckedKeys=o)},null,8,["tree-data","expandedKeys","checkedKeys"])]),_:1},8,["onConfirm"])])}var je=ce(Fe,[["render",ke]]);export{je as default};
